"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7734],{87734:(e,t,s)=>{s.d(t,{Ay:()=>b});var r=Object.defineProperty,i=(e,t,s)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,a=(e,t,s)=>i(e,"symbol"!=typeof t?t+"":t,s);class n extends Error{constructor(e){super(e),this.name="AbortError"}}class o{constructor(){a(this,"isCDNUrl",(e="")=>e.includes("/cdn/")),a(this,"getOptionsPage",(e,t=25,s=1)=>({...e,per_page:t,page:s})),a(this,"delay",e=>new Promise(t=>setTimeout(t,e))),a(this,"arrayFrom",(e=0,t)=>Array.from({length:e},t)),a(this,"range",(e=0,t=e)=>{let s=Math.abs(t-e)||0,r=e<t?1:-1;return this.arrayFrom(s,(t,s)=>s*r+e)}),a(this,"asyncMap",async(e,t)=>Promise.all(e.map(t))),a(this,"flatMap",(e=[],t)=>e.map(t).reduce((e,t)=>[...e,...t],[])),a(this,"escapeHTML",function(e){let t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},s=/[&<>"']/g,r=new RegExp(s.source);return e&&r.test(e)?e.replace(s,e=>t[e]):e})}stringify(e,t,s){let r=[];for(let i in e){let a;if(!Object.prototype.hasOwnProperty.call(e,i))continue;let n=e[i],o=s?"":encodeURIComponent(i);a="object"==typeof n?this.stringify(n,t?t+encodeURIComponent(`[${o}]`):o,Array.isArray(n)):`${t?t+encodeURIComponent(`[${o}]`):o}=${encodeURIComponent(n)}`,r.push(a)}return r.join("&")}getRegionURL(e){switch(e){case"us":return"api-us.storyblok.com";case"cn":return"app.storyblokchina.cn";case"ap":return"api-ap.storyblok.com";case"ca":return"api-ca.storyblok.com";default:return"api.storyblok.com"}}}let l=function(e,t){let s={};for(let r in e){let i=e[r];t.includes(r)&&null!==i&&(s[r]=i)}return s},h=e=>"email"===e,c={nodes:{horizontal_rule:()=>({singleTag:"hr"}),blockquote:()=>({tag:"blockquote"}),bullet_list:()=>({tag:"ul"}),code_block:e=>({tag:["pre",{tag:"code",attrs:e.attrs}]}),hard_break:()=>({singleTag:"br"}),heading:e=>({tag:`h${e.attrs.level}`}),image:e=>({singleTag:[{tag:"img",attrs:l(e.attrs,["src","alt","title"])}]}),list_item:()=>({tag:"li"}),ordered_list:()=>({tag:"ol"}),paragraph:()=>({tag:"p"}),emoji:e=>({tag:[{tag:"span",attrs:{"data-type":"emoji","data-name":e.attrs.name,emoji:e.attrs.emoji}}]})},marks:{bold:()=>({tag:"b"}),strike:()=>({tag:"s"}),underline:()=>({tag:"u"}),strong:()=>({tag:"strong"}),code:()=>({tag:"code"}),italic:()=>({tag:"i"}),link:e=>{if(!e.attrs)return{tag:""};let t=new o().escapeHTML,s={...e.attrs},{linktype:r="url"}=e.attrs;if(delete s.linktype,s.href&&(s.href=t(e.attrs.href||"")),h(r)&&(s.href=`mailto:${s.href}`),s.anchor&&(s.href=`${s.href}#${s.anchor}`,delete s.anchor),s.custom){for(let e in s.custom)s[e]=s.custom[e];delete s.custom}return{tag:[{tag:"a",attrs:s}]}},styled:e=>({tag:[{tag:"span",attrs:e.attrs}]}),subscript:()=>({tag:"sub"}),superscript:()=>({tag:"sup"}),anchor:e=>({tag:[{tag:"span",attrs:e.attrs}]}),highlight:e=>{var t;return null!=(t=e.attrs)&&t.color?{tag:[{tag:"span",attrs:{style:`background-color:${e.attrs.color};`}}]}:{tag:""}},textStyle:e=>{var t;return null!=(t=e.attrs)&&t.color?{tag:[{tag:"span",attrs:{style:`color:${e.attrs.color}`}}]}:{tag:""}}}},u=function(e){let t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},s=/[&<>"']/g,r=new RegExp(s.source);return e&&r.test(e)?e.replace(s,e=>t[e]):e},p=!1;class g{constructor(e){a(this,"marks"),a(this,"nodes"),e||(e=c),this.marks=e.marks||[],this.nodes=e.nodes||[]}addNode(e,t){this.nodes[e]=t}addMark(e,t){this.marks[e]=t}render(e,t={optimizeImages:!1},s=!0){if(!p&&s&&(console.warn("Warning ⚠️: The RichTextResolver class is deprecated and will be removed in the next major release. Please use the `@storyblok/richtext` package instead. https://github.com/storyblok/richtext/"),p=!0),e&&e.content&&Array.isArray(e.content)){let s="";return e.content.forEach(e=>{s+=this.renderNode(e)}),t.optimizeImages?this.optimizeImages(s,t.optimizeImages):s}return console.warn(`The render method must receive an Object with a "content" field.
      The "content" field must be an array of nodes as the type ISbRichtext.
      ISbRichtext:
        content?: ISbRichtext[]
        marks?: ISbRichtext[]
        attrs?: any
        text?: string
        type: string
        
        Example:
        {
          content: [
            {
              content: [
                {
                  text: 'Hello World',
                  type: 'text'
                }
              ],
              type: 'paragraph'
            }
          ],
          type: 'doc'
        }`),""}optimizeImages(e,t){let s=0,r=0,i="",a="";"boolean"!=typeof t&&("number"==typeof t.width&&t.width>0&&(i+=`width="${t.width}" `,s=t.width),"number"==typeof t.height&&t.height>0&&(i+=`height="${t.height}" `,r=t.height),("lazy"===t.loading||"eager"===t.loading)&&(i+=`loading="${t.loading}" `),"string"==typeof t.class&&t.class.length>0&&(i+=`class="${t.class}" `),t.filters&&("number"==typeof t.filters.blur&&t.filters.blur>=0&&t.filters.blur<=100&&(a+=`:blur(${t.filters.blur})`),"number"==typeof t.filters.brightness&&t.filters.brightness>=-100&&t.filters.brightness<=100&&(a+=`:brightness(${t.filters.brightness})`),t.filters.fill&&(t.filters.fill.match(/[0-9A-F]{6}/gi)||"transparent"===t.filters.fill)&&(a+=`:fill(${t.filters.fill})`),t.filters.format&&["webp","png","jpeg"].includes(t.filters.format)&&(a+=`:format(${t.filters.format})`),"boolean"==typeof t.filters.grayscale&&t.filters.grayscale&&(a+=":grayscale()"),"number"==typeof t.filters.quality&&t.filters.quality>=0&&t.filters.quality<=100&&(a+=`:quality(${t.filters.quality})`),t.filters.rotate&&[90,180,270].includes(t.filters.rotate)&&(a+=`:rotate(${t.filters.rotate})`),a.length>0&&(a=`/filters${a}`))),i.length>0&&(e=e.replace(/<img/g,`<img ${i.trim()}`));let n=s>0||r>0||a.length>0?`${s}x${r}${a}`:"";return e=e.replace(/a.storyblok.com\/f\/(\d+)\/([^.]+)\.(gif|jpg|jpeg|png|tif|bmp)/g,`a.storyblok.com/f/$1/$2.$3/m/${n}`),"boolean"!=typeof t&&(t.sizes||t.srcset)&&(e=e.replace(/<img.*?src=["|'](.*?)["|']/g,e=>{var s,r;let i=e.match(/a.storyblok.com\/f\/(\d+)\/([^.]+)\.(gif|jpg|jpeg|png|tif|bmp)/g);if(i&&i.length>0){let n={srcset:null==(s=t.srcset)?void 0:s.map(e=>{if("number"==typeof e)return`//${i}/m/${e}x0${a} ${e}w`;if("object"==typeof e&&2===e.length){let t=0,s=0;return"number"==typeof e[0]&&(t=e[0]),"number"==typeof e[1]&&(s=e[1]),`//${i}/m/${t}x${s}${a} ${t}w`}return""}).join(", "),sizes:null==(r=t.sizes)?void 0:r.map(e=>e).join(", ")},o="";return n.srcset&&(o+=`srcset="${n.srcset}" `),n.sizes&&(o+=`sizes="${n.sizes}" `),e.replace(/<img/g,`<img ${o.trim()}`)}return e})),e}renderNode(e){let t=[];e.marks&&e.marks.forEach(e=>{let s=this.getMatchingMark(e);s&&""!==s.tag&&t.push(this.renderOpeningTag(s.tag))});let s=this.getMatchingNode(e);return s&&s.tag&&t.push(this.renderOpeningTag(s.tag)),e.content?e.content.forEach(e=>{t.push(this.renderNode(e))}):e.text?t.push(u(e.text)):s&&s.singleTag?t.push(this.renderTag(s.singleTag," /")):s&&s.html?t.push(s.html):"emoji"===e.type&&t.push(this.renderEmoji(e)),s&&s.tag&&t.push(this.renderClosingTag(s.tag)),e.marks&&e.marks.slice(0).reverse().forEach(e=>{let s=this.getMatchingMark(e);s&&""!==s.tag&&t.push(this.renderClosingTag(s.tag))}),t.join("")}renderTag(e,t){return e.constructor===String?`<${e}${t}>`:e.map(e=>{if(e.constructor===String)return`<${e}${t}>`;{let s=`<${e.tag}`;if(e.attrs){for(let t in e.attrs)if(Object.prototype.hasOwnProperty.call(e.attrs,t)){let r=e.attrs[t];null!==r&&(s+=` ${t}="${r}"`)}}return`${s}${t}>`}}).join("")}renderOpeningTag(e){return this.renderTag(e,"")}renderClosingTag(e){return e.constructor===String?`</${e}>`:e.slice(0).reverse().map(e=>e.constructor===String?`</${e}>`:`</${e.tag}>`).join("")}getMatchingNode(e){let t=this.nodes[e.type];if("function"==typeof t)return t(e)}getMatchingMark(e){let t=this.marks[e.type];if("function"==typeof t)return t(e)}renderEmoji(e){if(e.attrs.emoji)return e.attrs.emoji;let t=[{tag:"img",attrs:{src:e.attrs.fallbackImage,draggable:"false",loading:"lazy",align:"absmiddle"}}];return this.renderTag(t," /")}}class d{constructor(e){a(this,"baseURL"),a(this,"timeout"),a(this,"headers"),a(this,"responseInterceptor"),a(this,"fetch"),a(this,"ejectInterceptor"),a(this,"url"),a(this,"parameters"),a(this,"fetchOptions"),this.baseURL=e.baseURL,this.headers=e.headers||new Headers,this.timeout=null!=e&&e.timeout?1e3*e.timeout:0,this.responseInterceptor=e.responseInterceptor,this.fetch=(...t)=>e.fetch?e.fetch(...t):fetch(...t),this.ejectInterceptor=!1,this.url="",this.parameters={},this.fetchOptions={}}get(e,t){return this.url=e,this.parameters=t,this._methodHandler("get")}post(e,t){return this.url=e,this.parameters=t,this._methodHandler("post")}put(e,t){return this.url=e,this.parameters=t,this._methodHandler("put")}delete(e,t){return this.url=e,this.parameters=t??{},this._methodHandler("delete")}async _responseHandler(e){let t=[],s={data:{},headers:{},status:0,statusText:""};for(let r of(204!==e.status&&await e.json().then(e=>{s.data=e}),e.headers.entries()))t[r[0]]=r[1];return s.headers={...t},s.status=e.status,s.statusText=e.statusText,s}async _methodHandler(e){let t,s=`${this.baseURL}${this.url}`,r=null;if("get"===e){let e=new o;s=`${this.baseURL}${this.url}?${e.stringify(this.parameters)}`}else r=JSON.stringify(this.parameters);let i=new URL(s),a=new AbortController,{signal:n}=a;this.timeout&&(t=setTimeout(()=>a.abort(),this.timeout));try{let s=await this.fetch(`${i}`,{method:e,headers:this.headers,body:r,signal:n,...this.fetchOptions});this.timeout&&clearTimeout(t);let a=await this._responseHandler(s);return this.responseInterceptor&&!this.ejectInterceptor?this._statusHandler(this.responseInterceptor(a)):this._statusHandler(a)}catch(e){return{message:e}}}setFetchOptions(e={}){Object.keys(e).length>0&&"method"in e&&delete e.method,this.fetchOptions={...e}}eject(){this.ejectInterceptor=!0}_statusHandler(e){let t=/20[0-6]/g;return new Promise((s,r)=>{if(t.test(`${e.status}`))return s(e);r({message:e.statusText,status:e.status,response:Array.isArray(e.data)?e.data[0]:e.data.error||e.data.slug})})}}let f="SB-Agent",m={defaultAgentName:"SB-JS-CLIENT",defaultAgentVersion:"SB-Agent-Version",packageVersion:"6.0.0"},y={},v={};class b{constructor(e,t){a(this,"client"),a(this,"maxRetries"),a(this,"retriesDelay"),a(this,"throttle"),a(this,"accessToken"),a(this,"cache"),a(this,"helpers"),a(this,"resolveCounter"),a(this,"relations"),a(this,"links"),a(this,"richTextResolver"),a(this,"resolveNestedRelations"),a(this,"stringifiedStoriesCache");let s=e.endpoint||t;if(!s){let t=new o().getRegionURL,r=!1===e.https?"http":"https";s=e.oauthToken?`${r}://${t(e.region)}/v1`:`${r}://${t(e.region)}/v2`}let r=new Headers;r.set("Content-Type","application/json"),r.set("Accept","application/json"),e.headers&&("Headers"===e.headers.constructor.name?e.headers.entries().toArray():Object.entries(e.headers)).forEach(([e,t])=>{r.set(e,t)}),r.has(f)||(r.set(f,m.defaultAgentName),r.set(m.defaultAgentVersion,m.packageVersion));let i=5;e.oauthToken&&(r.set("Authorization",e.oauthToken),i=3),e.rateLimit&&(i=e.rateLimit),e.richTextSchema?this.richTextResolver=new g(e.richTextSchema):this.richTextResolver=new g,e.componentResolver&&this.setComponentResolver(e.componentResolver),this.maxRetries=e.maxRetries||10,this.retriesDelay=300,this.throttle=function(e,t,s){if(!Number.isFinite(t))throw TypeError("Expected `limit` to be a finite number");if(!Number.isFinite(1e3))throw TypeError("Expected `interval` to be a finite number");let r=[],i=[],a=0,o=!1,l=async()=>{a++;let t=r.shift();if(t)try{let s=await e(...t.args);t.resolve(s)}catch(e){t.reject(e)}let s=setTimeout(()=>{a--,r.length>0&&l(),i=i.filter(e=>e!==s)},1e3);i.includes(s)||i.push(s)},h=(...e)=>o?Promise.reject(Error("Throttled function is already aborted and not accepting new promises")):new Promise((s,i)=>{r.push({resolve:s,reject:i,args:e}),a<t&&l()});return h.abort=()=>{o=!0,i.forEach(clearTimeout),i=[],r.forEach(e=>e.reject(()=>new n("Throttle function aborted"))),r.length=0},h}(this.throttledRequest.bind(this),i,1e3),this.accessToken=e.accessToken||"",this.relations={},this.links={},this.cache=e.cache||{clear:"manual"},this.helpers=new o,this.resolveCounter=0,this.resolveNestedRelations=e.resolveNestedRelations||!0,this.stringifiedStoriesCache={},this.client=new d({baseURL:s,timeout:e.timeout||0,headers:r,responseInterceptor:e.responseInterceptor,fetch:e.fetch})}setComponentResolver(e){this.richTextResolver.addNode("blok",t=>{let s="";return t.attrs.body&&t.attrs.body.forEach(t=>{s+=e(t.component,t)}),{html:s}})}parseParams(e){return e.token||(e.token=this.getToken()),e.cv||(e.cv=v[e.token]),Array.isArray(e.resolve_relations)&&(e.resolve_relations=e.resolve_relations.join(",")),"u">typeof e.resolve_relations&&(e.resolve_level=2),e}factoryParamOptions(e,t){return this.helpers.isCDNUrl(e)?this.parseParams(t):t}makeRequest(e,t,s,r,i){let a=this.factoryParamOptions(e,this.helpers.getOptionsPage(t,s,r));return this.cacheResponse(e,a,void 0,i)}get(e,t,s){t||(t={});let r=`/${e}`,i=this.factoryParamOptions(r,t);return this.cacheResponse(r,i,void 0,s)}async getAll(e,t,s,r){let i=(null==t?void 0:t.per_page)||25,a=`/${e}`.replace(/\/$/,""),n=s??a.substring(a.lastIndexOf("/")+1),o=await this.makeRequest(a,t,i,1,r),l=o.total?Math.ceil(o.total/i):1,h=await this.helpers.asyncMap(this.helpers.range(1,l),e=>this.makeRequest(a,t,i,e+1,r));return this.helpers.flatMap([o,...h],e=>Object.values(e.data[n]))}post(e,t,s){let r=`/${e}`;return Promise.resolve(this.throttle("post",r,t,s))}put(e,t,s){let r=`/${e}`;return Promise.resolve(this.throttle("put",r,t,s))}delete(e,t,s){t||(t={});let r=`/${e}`;return Promise.resolve(this.throttle("delete",r,t,s))}getStories(e,t){return this._addResolveLevel(e),this.get("cdn/stories",e,t)}getStory(e,t,s){return this._addResolveLevel(t),this.get(`cdn/stories/${e}`,t,s)}getToken(){return this.accessToken}ejectInterceptor(){this.client.eject()}_addResolveLevel(e){"u">typeof e.resolve_relations&&(e.resolve_level=2)}_cleanCopy(e){return JSON.parse(JSON.stringify(e))}_insertLinks(e,t,s){let r=e[t];r&&"multilink"===r.fieldtype&&"story"===r.linktype&&"string"==typeof r.id&&this.links[s][r.id]?r.story=this._cleanCopy(this.links[s][r.id]):r&&"story"===r.linktype&&"string"==typeof r.uuid&&this.links[s][r.uuid]&&(r.story=this._cleanCopy(this.links[s][r.uuid]))}getStoryReference(e,t){return this.relations[e][t]?JSON.parse(this.stringifiedStoriesCache[t]||JSON.stringify(this.relations[e][t])):t}_resolveField(e,t,s){let r=e[t];"string"==typeof r?e[t]=this.getStoryReference(s,r):Array.isArray(r)&&(e[t]=r.map(e=>this.getStoryReference(s,e)).filter(Boolean))}_insertRelations(e,t,s,r){if(Array.isArray(s)?s.find(e=>e.endsWith(`.${t}`)):s.endsWith(`.${t}`)){this._resolveField(e,t,r);return}let i=e.component?`${e.component}.${t}`:t;(Array.isArray(s)?s.includes(i):s===i)&&this._resolveField(e,t,r)}iterateTree(e,t,s){let r=(e,i="")=>{if(!(!e||e._stopResolving)){if(Array.isArray(e))e.forEach((e,t)=>r(e,`${i}[${t}]`));else if("object"==typeof e)for(let a in e){let n=i?`${i}.${a}`:a;(e.component&&e._uid||"link"===e.type)&&(this._insertRelations(e,a,t,s),this._insertLinks(e,a,s)),r(e[a],n)}}};r(e.content)}async resolveLinks(e,t,s){let r=[];if(e.link_uuids){let s=e.link_uuids.length,i=[];for(let t=0;t<s;t+=50){let r=Math.min(s,t+50);i.push(e.link_uuids.slice(t,r))}for(let e=0;e<i.length;e++)(await this.getStories({per_page:50,language:t.language,version:t.version,by_uuids:i[e].join(",")})).data.stories.forEach(e=>{r.push(e)})}else r=e.links;r.forEach(e=>{this.links[s][e.uuid]={...e,_stopResolving:!0}})}async resolveRelations(e,t,s){let r=[];if(e.rel_uuids){let s=e.rel_uuids.length,i=[];for(let t=0;t<s;t+=50){let r=Math.min(s,t+50);i.push(e.rel_uuids.slice(t,r))}for(let e=0;e<i.length;e++)(await this.getStories({per_page:50,language:t.language,version:t.version,by_uuids:i[e].join(","),excluding_fields:t.excluding_fields})).data.stories.forEach(e=>{r.push(e)})}else r=e.rels;r&&r.length>0&&r.forEach(e=>{this.relations[s][e.uuid]={...e,_stopResolving:!0}})}async resolveStories(e,t,s){var r,i;let a=[];if(this.links[s]={},this.relations[s]={},"u">typeof t.resolve_relations&&t.resolve_relations.length>0&&("string"==typeof t.resolve_relations&&(a=t.resolve_relations.split(",")),await this.resolveRelations(e,t,s)),t.resolve_links&&["1","story","url","link"].includes(t.resolve_links)&&(null!=(r=e.links)&&r.length||null!=(i=e.link_uuids)&&i.length)&&await this.resolveLinks(e,t,s),this.resolveNestedRelations)for(let e in this.relations[s])this.iterateTree(this.relations[s][e],a,s);e.story?this.iterateTree(e.story,a,s):e.stories.forEach(e=>{this.iterateTree(e,a,s)}),this.stringifiedStoriesCache={},delete this.links[s],delete this.relations[s]}async cacheResponse(e,t,s,r){let i=this.helpers.stringify({url:e,params:t}),a=this.cacheProvider();if("auto"===this.cache.clear&&"draft"===t.version&&await this.flushCache(),"published"===t.version&&"/cdn/spaces/me"!==e){let e=await a.get(i);if(e)return Promise.resolve(e)}return new Promise(async(n,o)=>{var l;try{let s=await this.throttle("get",e,t,r);if(200!==s.status)return o(s);let h={data:s.data,headers:s.headers};if(null!=(l=s.headers)&&l["per-page"]&&(h=Object.assign({},h,{perPage:s.headers["per-page"]?Number.parseInt(s.headers["per-page"]):0,total:s.headers["per-page"]?Number.parseInt(s.headers.total):0})),h.data.story||h.data.stories){let e=this.resolveCounter=++this.resolveCounter%1e3;await this.resolveStories(h.data,t,`${e}`)}return"published"===t.version&&"/cdn/spaces/me"!==e&&await a.set(i,h),h.data.cv&&t.token&&v[t.token]!==h.data.cv&&(await this.flushCache(),v[t.token]=h.data.cv),n(h)}catch(r){if(r.response&&429===r.status&&(s=typeof s>"u"?0:s+1)<this.maxRetries)return console.log(`Hit rate limit. Retrying in ${this.retriesDelay/1e3} seconds.`),await this.helpers.delay(this.retriesDelay),this.cacheResponse(e,t,s).then(n).catch(o);o(r)}})}throttledRequest(e,t,s,r){return this.client.setFetchOptions(r),this.client[e](t,s)}cacheVersions(){return v}cacheVersion(){return v[this.accessToken]}setCacheVersion(e){this.accessToken&&(v[this.accessToken]=e)}clearCacheVersion(){this.accessToken&&(v[this.accessToken]=0)}cacheProvider(){switch(this.cache.type){case"memory":return{get:e=>Promise.resolve(y[e]),getAll:()=>Promise.resolve(y),set:(e,t)=>(y[e]=t,Promise.resolve(void 0)),flush:()=>(y={},Promise.resolve(void 0))};case"custom":if(this.cache.custom)return this.cache.custom;default:return{get:()=>Promise.resolve(),getAll:()=>Promise.resolve(void 0),set:()=>Promise.resolve(void 0),flush:()=>Promise.resolve(void 0)}}}async flushCache(){return await this.cacheProvider().flush(),this.clearCacheVersion(),this}}}}]);
//# sourceMappingURL=7734-f280ed00a5bac621.js.map